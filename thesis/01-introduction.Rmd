# Introduction

Forests cover approximately 30% of the earth's surface and play a critical role in the water and carbon cycles [@laurent2011inversion]. As forest environments are being threatened more and more, there is an increased concern for forest conservation [@grammatikopoulou2021value]. The effects of climate change on many different ecosystems have been studied and shown. Forest ecosystems are particularly more sensitive to climate change compared to other ecosystems [@esquivel2019compositional; @lindner2010climate]. According to @lindner2010climate, the primary reason forest ecosystems are particularly susceptible to extraordinary climate changes is because, in comparison to other organisms, trees typically live longer and have fewer adaptive abilities to cope with rapid environmental changes.

Another threat to the forest that has been increasingly reported during the last century is insect disturbances. Insect disturbances have increased the concern about forest species diversity, biogeochemical cycle and the economic value of forest ecosystems [@senf2017remote]. The main forest insects that are responsible for many outbreaks can be divided into bark beetles and defoliators. Many bark beetle species can reproduce their offspring within both dead and living tree organisms' phloem. These bark beetles can easily destroy the structure of translocation processes (e.g. water and nutrient translocations) by introducing various pathogens (e.g. fungal) into healthy trees [@senf2017remote].

A study by @kautz2017biotic has reported that there is only a limited amount of consistent data for studying forest disturbance caused by insects [@senf2017remote]. Remote sensing images provide very interesting insights into studying environmental disturbances and changes within forest areas. According to the study by @lechner2020applications, remote sensing techniques have recently been actively used for forest studies. For example, remote sensing images are offering important opportunities to map ecosystem distribution, to study forest plant productivity and to get insights about the 3D structural properties of forest plants [@lechner2020applications]. 

One of the most important insights remote sensing provides is the fact that the image of the earth's surface can be acquired over time. This gives a unique opportunity to be able to study environmental changes in a specific area of interest over the time period the images are acquired. For example, there have been studies where remote sensing techniques were used to map the distribution of invasive species and to monitor land changes (e.g. forest habitat fragmentation) in forests [@lechner2020applications].

Another interesting opportunity that remote sensing data provides is to estimate vegetation biophysical and biochemical properties from remotely sensed images. Essentially, there are various ways to retrieve plant biophysical parameters from remote sensing data. Each method has its own advantages and disadvantages. The radiative transfer model (RTM) has been accepted to be the superior method to all the available techniques [@darvishzadeh2019analysis; @wang2018mapping]. Various RTMs have been proposed at different scales, such as leaf and canopy scales. Different RTMs such as leaf and canopy can be used in a coupled mode in order to simulate canopy reflectance based on vegetation biophysical and biochemical properties [@morcillo2019quantifying].

There are mainly three inversion methods to estimate plant traits from remote sensing data. These methods are numerical optimization, look-up-table and hybrid techniques. Numerical optimization is considered to be a classical method. However, the major drawbacks of this method are its computational inefficiency and the high risk of poor convergence [@zhang2021analyzing]. The LUT method refers to a technique where databases to store simulated data are created by RTMs. And then, plant biophysical variables of the simulated reflectance that represent the measured data most closely are chosen as retrievals. Although the LUT method is more efficient than the classic numerical optimization, it is still a computationally inefficient process given that inversion needs to be done for each pixel in the remote sensing product [@danner2021efficient]. The hybrid method can be used to overcome the challenges of these less efficient techniques. In a typical hybrid method, a regression model is combined with RTMs [@zhang2021analyzing].

Invertable Forest Reflectance Model (INFORM) is a combination of three RTMs (leaf and canopy) that can be used to simulate forest canopy reflectance in terms of canopy biophysical and biochemical parameters [@atzberger2000development; @schlerf2006inversion]. INFORM and machine learning models can be combined using a hybrid method to retrieve plant traits.

The main objectives of this study are to:

1. simulate forest canopy reflectance (for the national park Hunsrück-Hochwald) using the more recent submodels (PROSPECT5, 4SAIL and FLIM) of the coupled chain RTM INFORM
2. train Artificial Neural Networks (ANN) using the simulated canopy reflectance data in order to assess whether the relationship between plant traits and spectral data can be efficiently learned
3. assess whether the trained ANN can deal with collinearity occurring in hyperspectral remote sensing data
4. retrieve forest biophysical and biochemical maps for the study area Hunsrück-Hochwald

## Forest Disturbances by Bark Beetle

Insect disturbance is just one of the numerous natural disturbances that forests face. Insect outbreaks can have a significant impact on the functioning of an ecosystem [@raffa2009literal]. However, there have been concerns regarding these forest disturbances as severity and frequency of these disturbances have increased [@millar2015temperate].

One of the major insect contributors to European forest disturbances is called the European spruce bark beetle (*Ips typographus*). These bark beetles have been increasingly destroying European forests. These pest organisms specifically affects Norway spruce forests, as *Ips typographus*s are major pests of Norway spruce trees [@ohrn2014seasonal]. Temperature has a significant effect on the successful swarm of *Ips typographus*. The temperature of 16.5$^\circ$ is considered to be the minimum temperature (lower threshold) for the bark beetle to swarm and attack the trees. The length of warm days is another factor increasing the chance of successful attack by the bark beetle. The European spruce trees have defense mechanisms to fight against the mass beetle outbreak. However, when there are at least three warm days in a row with a temperature well-above the swarming threshold of *Ips typographus*, then the likelihood of these pest organisms successfully overcoming the defense mechanisms of the trees and infesting them is higher [@wermelinger2004ecology].

Once a tree is infested, there are typically three stages that the tree will go through. These stages are called the green attack, red attack and gray attack stages [@sprintsin2011combining]. The green attack stage is the first stage and it refers to a stage where usually the leaves of the infested trees are still green. At this stage, it is difficult to distinguish the infested trees at the canopy level [@wulder2006estimating]. During the green attack stage, the infested tree may still be alive, but once this stage has started, the death of the infested tree is inevitable. Moreover, during this stage, the freshly hatched generation of the bark beetle uses the inner bark of the tree to grow and develop [@niemann2005assessment]. The next stage is called the red attack stage. During this phase, the leaves of the infested trees slowly turn yellow and eventually become reddish [@fernandez2020monitoring]. The red attack stage occurs within the next year (one year) after the bark beetles perform a mass attack [@niemann2005assessment]. The final stage is the gray attack stage, which refers to a stage where the trees have already shed their leaves [@wulder2009challenges]. At this point, the infested trees are completely dead and abandoned by the new generation of the bark beetle [@niemann2005assessment]. During the final stage, typically only the gray bark of the tree is left. Hence, this stage is called the gray stage [@abdullah2019sensitivity].

Bark beetles are known to have a mutual (symbiotic) relationship with many different fungi species (e.g. *Ceratocystis spp*). These fungi species can easily infect trees. Sapwood and phloem of the trees are specifically affected by these species [@niemann2005assessment; @six2003genetic]. Once the trees are infected by the fungi carried by bark beetles, these fungi will start to disrupt the translocation of water and important nutrients in the infected tree [@paine1997interactions; @wermelinger2004ecology]. These are potentially causing changes in both biophysical and biochemical properties at the canopy and leaf level [@abdullah2018european].

There are several factors that help *Ips typographus* to attack trees successfully. One of the major contributors to this process is thought to be climate change. Typically, when bark beetles exist at natural and low densities, they cannot overcome the defense mechanisms of the trees. Climate change, on the other hand, is facilitating these beetles' successful attack in numerous ways. Increased length and number of warm and very dry days, for example, significantly increase the likelihood of a mass bark beetle outbreak. Specifically, these factors trigger beetle attacks in two ways: directly (e.g. increased insect population) and indirectly (e.g. weakened tree defence mechanisms against bark beetle) [@bale2002herbivory; @bentz2015modeling; @marini2017climate].

Effective forest management and early intervention is essential in order to deal with bark beetle outbreaks. Detecting the infested trees while they are still going through the green attack stage is essential, because at this point, the beetles have not yet left the tree to look for new host trees. One of the traditional ways of identifying and assessing infested trees is through manual field surveys. Typically, these surveys are performed by foresters who try to look for sawdust within the bark of the trees. However, this method is extremely difficult, time-consuming and require a lot of labor to study large forest areas. The field of remote sensing, however, offers methods to more effectively detect and map forest infestations [@abdullah2019sentinel; @immitzer2014early]. 

@immitzer2014early used World-View-2 data in order to study and detect bark beetle infestations during the green attack stage. In this study, a forest infestation map was produced using a machine learning method. Study by @ortiz2013early used RapidEye and TerraSAR-X data for early detection of bark beetle. This study demonstrated the use of statistical and machine learning methods for bark beetle detection. @lausch2013forecasting used hyperspectral airborne data HyMap to study early detection of bark beetle infestations with a limited amount of success. In the study by @lausch2013forecasting, single and multi-date Landsat data were successfully utilized to study forest disturbance by the bark beetle.

There have only been limited studies assessing the effect of the bark beetle green attack stage on plant biophysical and biochemical properties. A study by @abdullah2018european showed that there is a significant difference in leaf chlorophyll and nitrogen content between healthy and infested trees during the green attack stage. This study also concluded that spectral responses (using in-situ data) between healthy and infested trees were significantly different. Work by @abdullah2019sentinel concluded that the leaf chlorophyll and water content of healthy plants were significantly higher than infested trees at the green attack stage. They found dry matter content to be significantly higher for infested trees than healthy trees. A recent study by @ali2021canopy for the first time demonstrated the use of canopy chlorophyll content time series data retrieved from multispectral remote sensing data using the INFORM RTM for bark beetle infestation detection.

## Radiative Transfer Models (RTM) {#rtm}

Radiative transfer models take advantage of physical laws that determine "causal and effect" relationships. There have been various radiative transfer models developed (leaf, canopy etc.) during the last decades [@verrelst2019quantifying].

@combal2003retrieval describe that RTM inversion process involves modifying the vegetation biophysical parameters (variables) $V = \{V_{1}, V_{2},  ..., V_{n_{var}}\}$ in such a way that the simulated canopy reflectance simulated by an RTM $M$ is most similar to the canopy reflectance $R$ measured by a remote sensing sensor. The $n_{var}$ number of canopy variables and geometric parameters $C$ are required by the RTM $M$. It is also important to mention that the inversion is achieved with an error or uncertainty, namely $\varepsilon$:

\begin{equation}
R\ =\ M\left(V,\ C\right)\ +\varepsilon
(\#eq:rtm)
\end{equation}

The error term $\varepsilon$ in the Equation \@ref(eq:rtm) refers to the uncertainties in both measured and modeled canopy reflectance [@combal2003retrieval].

Radiative transfer models can be used to retrieve forest canopy biophysical and biochemical variables from remote sensing satellite data. This chapter mainly focuses on a coupled-chain radiative transfer model called the Invertable Forest Reflectance Model (INFORM) and its sub-models. INFORM combines leaf and canopy radiative transfer models [@atzberger2000development], namely PROSPECT, SAIL (Scattering by Arbitrary Inclined Leaves) and FLIM (Forest Light Interaction Model) models [@schlerf2006inversion]. There are different versions of some of these sub-models (PROSPECT4, PROSPECT5 etc.). This chapter specifically reviews the PROSPECT5, 4SAIL and FLIM models. 

### Leaf Radiative Transfer Model - PROSPECT {#prospect}

In essence, PROSPECT is a leaf Radiative Transfer Model (RTM) that takes as an input leaf plant variables and outputs leaf reflectance and transmittance for the wavelength range of 400nm-2500nm [@jacquemoud1990prospect]. According to @yang2021improving, several versions of this leaf model have been developed during recent years. For example, the PROSPECT4 and PROSPECT5 models are two of the recent and improved versions of the previously proposed models. The main advantage of PROSPECT5 over PROSPECT4 is that the PROSPECT5 version takes cartenoid content of the leaf into account apart from chlorophyll (a+b) content separately [@yang2021improving]. 

Reflectance and transmittance of plant leaves are known to be driven by leaf biochemical parameters. The PROSPECT models have been successfully used both to simulate leaf optical properties (transmittance and reflectance) and vegetation leaf biochemical variables. One of the main strengths of this model is that it can easily be applied to many different plant species living under various environmental conditions [@yang2021improving]. In the PROSPECT5 model, leaf reflectance and transmittance are treated as a function of 6 plant leaf parameters (Table \@ref(tab:prospect5)) [@jacquemoud2019leaf].

```{r, include=FALSE}
library(dplyr)
```

```{r prospect5, echo=FALSE, warning=FALSE, message=FALSE, cache=TRUE}
source(".\\tables\\prospect5.R")
knitr::kable(prospect5_df, caption = "Input parameters of PROSPECT5",
             escape = FALSE, booktabs = TRUE) %>%
        kableExtra::kable_styling(latex_options = "HOLD_position", full_width = T) %>%
        kableExtra::column_spec(1, width = "8cm")
```

These leaf parameters (Table \@ref(tab:prospect5)) can give very important insights about the plant's health status. For example, the chlorophyll (a+b) content of a plant leaf is a useful indicator of plant photosynthetic functioning [@darvishzadeh2019mapping, @feret2008prospect]. Chlorophyll is one of the most important plant traits that can also be used to understand plant infestations and diseases [@darvishzadeh2019mapping]. Ecological and environmental stresses can impact the cartenoids content of plants. Furthermore, there is a strong relationship between nitrogen and chlorophyll concentration [@feret2008prospect]. It is also important to note that, these parameters (e.g. chlorophyll content) can also be used to study the whole ecosystem functioning (e.g. ecosystem productivity) apart from being very useful for understanding individual plant health status [@darvishzadeh2019mapping].  

Some of these parameters can be analyzed in laboratories. For instance, the chlorophyll content of leaves can be analyzed in a laboratory, and laboratory techniques typically provide the most accurate results. However, these in-situ techniques are very expensive and invasive (e.g. destruction of the leaves is necessary). Here, remote sensing data are very advantageous as they offer a much more efficient methodology for retrieving these variables. Additionally, remote sensing data can cover a large spatial area, making it much more efficient to retrieve plant leaf parameters (Table \@ref(tab:prospect5)) for this specific area [@darvishzadeh2019mapping].

### Scattering by Arbitrary Inclined Leaves (SAIL) {#sail}

SAIL is a canopy radiative transfer model that is used in order to simulate bi-directional canopy reflectance [@verhoef1984light]. This model [@verhoef1984light] was extended from the study by @suits1971calculation. Furthermore, the 4SAIL model was proposed in the study by @verhoef2007unified, which is numerically much more optimized and computationally more efficient than the previously proposed versions. 

The SAIL model can be considered to be a simple model and takes only a few variables as its inputs. SAIL requires leaf reflectance and transmittance as well as background reflectance. Leaf transmittance and reflectance can be simulated using the PROSPECT model and directly fed into the SAIL model [@berger2018evaluation]. Table \@ref(tab:4sail) shows the input variables that the 4SAIL model requires.

```{r 4sail, echo=FALSE, warning=FALSE, message=FALSE, cache=TRUE}
source(".\\tables\\4sail.R")
knitr::kable(foursail_df, caption = "Input parameters of 4SAIL",
             escape = FALSE, booktabs = TRUE) %>%
        kableExtra::kable_styling(latex_options = "HOLD_position", full_width = T) %>%
        kableExtra::column_spec(1, width = "8cm")
```

The parameters observer zenith angle, sun zenith angle and sun-sensor azimuth angle (Table \@ref(tab:4sail)) are usually to be provided to the SAIL model explicitly. The parameter *Hotspot* refers to the ratio between leaf size and canopy height [@berger2018evaluation]. It is important to note that SAIL is mainly designed to work better with relatively homogeneous forests. However, some researchers have also shown that this model can yield reasonable results when used on heterogeneous canopies [@jay2017retrieving].

The PROSPECT and SAIL models can be combined together to simulate canopy reflectance. The combination of PROSPECT and SAIL models is usually called PROSAIL in the literature. PROSAIL is one of the most famous models that is used for simulation of canopy reflectance and estimation of plant biophysical parameters [@berger2018evaluation; @jay2017retrieving].

The PROSAIL model (Figure \@ref(fig:prosail)) can be used in a forward mode to get the simulated canopy reflectance based on the input parameters of PROSPECT (Table \@ref(tab:prospect5)) and SAIL (Table \@ref(tab:4sail)) [@berger2018evaluation].

```{r, prosail, echo=FALSE, fig.cap="Diagram of PROSAIL as a combination of PROSPECT5 and 4SAIL in the forward mode", crop=TRUE, cache=TRUE}
source(".\\figures\\prosail.R"); prosail
```

### Forest Light Interaction Model (FLIM) {#flim}

The FLIM model was first developed by @rosema1992new, and it has stochastic properties. The FLIM model assumes that forests consist of discontinues mixture of gaps and crowns. In this model, canopy reflectance is considered to be a probability of seeing a gap (ground) or crown [@rosema1992new]. Table \@ref(tab:flim) shows the input parameters of the FLIM model.

```{r flim, echo=FALSE, warning=FALSE, message=FALSE, cache=TRUE}
source(".\\tables\\flim.R")
knitr::kable(flim_df, caption = "Input parameters of FLIM",
             escape = FALSE, booktabs = TRUE) %>%
        kableExtra::kable_styling(latex_options = "HOLD_position", full_width = T) %>%
        kableExtra::column_spec(1, width = "8cm")
```

The FLIM model assumes that the background reflectance ($R_{g}$) is known [@rosema1992new] and it is the reflectance coming from the forest floor [@atzberger2000development]. Transmission in viewing ($T_{o}$) and sun ($T_{s}$) direction parameters (Table \@ref(tab:flim)) can be estimated using the SAIL model [@atzberger2000development; @schlerf2006inversion]. 

### Invertable Forest Reflectance Model (INFORM) {#inform}

The INFORM model was first developed by @atzberger2000development, and it consists of three sub-models. INFORM innovatively combines the three RTMs PROSPECT, SAIL and FLIM [@atzberger2000development; @schlerf2006inversion]. The INFORM model can be used to efficiently simulate forest canopy bi-directional reflectance within the wavelength range of 400nm-2500nm [@schlerf2006inversion] and, compared to other 3D radiative transfer models, INFORM requires fewer input variables [@atzberger2000development; @ali2020machine]. 

The SAIL model can be used to calculate the parameters transmittance in the viewing ($T_{o}$) and sun ($T_{s}$) directions (Table \@ref(tab:flim)) [@verhoef1984light]. However, in the SAIL model, the fact that the crown transmittance can be impacted (reduced) by woody parts of trees is ignored [@atzberger2000development]. Therefore, in the study by @atzberger2000development, it is shown that the INFORM model modifies the parameters transmittance in the viewing ($T_{o}$) and sun ($T_{s}$) direction in such a way that considers the shadow on the ground cast by woody parts of trees. However, in the study by @schlerf2006inversion, this technique was not applied because of the difficulties with parameterisation. Furthermore, INFORM represents leaf area index (LAI) as LAI of single trees ($LAI_{s}$) by dividing LAI by the canopy closure [@ali2016retrieval; @ali2020machine].

As the INFORM model is a combination of the three sub-models, its input parameters are simply the parameters of the sub-models. Therefore, the whole input parameters of the INFORM model can be found in Table \@ref(tab:prospect5) (PROSPECT5), Table \@ref(tab:4sail) (4SAIL) and Table \@ref(tab:flim) (FLIM). Figure \@ref(fig:inform) shows how INFORM can be used in the forward mode as a combination of PROSPECT5, 4SAIL and FLIM.


```{r, inform, echo=FALSE, fig.cap="Visualization of the INFORM model as a combination of PROSPECT5, 4SAIL and FLIM in the forward mode", crop=TRUE, cache=TRUE}
source(".\\figures\\inform.R"); inform
```

Successful applications of the INFORM model to retrieve forest biophysical parameters from hyperspectral remote sensing satellite data have been confirmed by various studies. For example, in the studies by @ali2016retrieval and @wang2017canopy, the INFORM model was successfully used to retrieve forest biophysical maps from the hyperspectral airborne remote sensing data HySpex. INFORM's suitability to be applied for multispectral remote sensing data was also proved in different studies. For example, @darvishzadeh2019mapping used the INFORM RTM in order to retrieve forest leaf chlorophyll content content maps from the multispectral remote sensing satellite data Sentinel-2 and RapidEye. @ali2020machine also utilized the INFORM model to retrieve forest canopy plant traits from Sentinel-2 multispectral remote sensing data.

### Challenges of RTMs {#chrtm}

One of the main challenges of the RTMs is the so-called ill-posed problem [@combal2003retrieval; @zhu2019estimation]. RTMs are mainly used for inversion problems. And inversion problems are usually ill-posed problems as opposed to well-posed problems. The ill-posed problem refers to a problem where multiple solutions can lead to similar or the same output. It makes the radiative transfer modelling process a very challenging process as multiple sets of solutions (e.g. leaf/canopy variables) can yield very similar simulated reflectance to the measured reflectance [@combal2003retrieval; @darvishzadeh2008estimation; @zhu2019estimation].

Fortunately, the problem of ill-posedness can be efficiently addressed using prior information [@combal2003retrieval; @darvishzadeh2008estimation; @zhu2019estimation]. @combal2003retrieval divides this prior information into three groups. The first category of prior information is to use data coming from the same spatial area but collected using another sensor (e.g. radar). The second type of prior information is the knowledge about the architecture of the canopy that is being studied. This knowledge could help decide what type of RTM to select (turbid medium, geometric etc.). Finally, the last type of prior information to be considered is the knowledge of the usual distribution range of biophysical and biochemical variables of canopies. This information can be gained with the help of either specialist/expert knowledge or by combining experimental data [@combal2003retrieval].

## Machine Learning Regression Algorithms (MLRA) {#mlra}

Machine Learning Regression Algorithms (MLRA) are non-linear and non-parametric techniques that can be used to retrieve forest biophysical and biochemical parameters. Apart from non-parametric methods, there are also parametric techniques that can be used for the same purpose. However, the main advantage of the non-parametric methods over the parametric ones is the fact that they often do not assume any underlying relationships between the response (e.g. plant traits) and predictor (e.g. canopy reflectance) variables. These models do not rely on any linearity, which makes them very compelling techniques that can be applied in various research fields [@sinha2020estimation; @rivera2015emulator; @verrelst2019quantifying].

According to the extensive review study by @verrelst2019quantifying, Decision Trees (DT), Kernel-Based Machine Learning Regression Methods (KBMLRM) and Artificial Neural Networks (ANN) are the three most widely used Machine Learning  (ML) families for retrieval of plant biophysical and biochemical variables in remote sensing. This chapter focuses on the most commonly used ML techniques and briefly reviews them.

### Decision Trees (DT) {#dt}

Decision Tree (DT) methods rely on trees and branches to illustrate the outcome of each decision [@verrelst2019quantifying]. The Random Forest (RF) is a non-parametric learning model and it is also considered to be an ensemble model [@breiman2001random]. Essentially, the Random Forest Regression (RFR) algorithm builds multiple small regression trees where each tree has a vote on the prediction. Based on the votes of each tree, a final prediction is made [@breiman2001random; @powell2010quantification]. The major advantage of the Random Forest model is that it is not sensitive to overfitting [@breiman2001random; @powell2010quantification; @verrelst2019quantifying], which is a well-known phenomenon challenging many ML algorithms' performance. Apart from that, the RF algorithm can successfully deal with large amounts of training data as well as outliers and noise in the training data. These properties are the reason why the RF model is an attractive method for plant trait mapping applications in remote sensing [@verrelst2019quantifying].

Essentially, there are two main parameters of the RF algorithm. These are the number of trees (ntree) and number of variables (mtry) that will be randomly sampled at every split [@wang2018estimation]. @breiman2001random suggests that a tree count of 500 (ntree = 500) may be sufficient in many cases.

The applicability of the RFR algorithm for retrieval of plant traits has been demonstrated in many studies. For example, @ali2020machine indicates that, when compared to the traditional Look Up Table (LUT) method with merit function, the RFR's retrieval accuracy was higher. In the studies by @han2016hyperspectral and @pullanagari2016mapping, RFR was compared to the other widely used ML algorithms (e.g. SVM). In these studies, no method was found to be significantly superior to one another, indicating that all the widely used ML methods are highly competitive [@verrelst2019quantifying].

### Kernel-Based Machine Learning Regression Methods (KBMLRM) {#kernel}

Kernel-based learning algorithms rely on turning the current dimension of the data into a higher dimension and solving non-linear problems using a kernel function. Kernel methods offer very flexible implementation and they can be efficiently utilized as long as the linear problem can be solved in terms of dot products (linear algebra) [@verrelst2019quantifying]. According to the review study by @gomez2011review, kernel-based methods play a very important role in the remote sensing field. Kernel-based models can efficiently deal with small number of training samples (training data), very high-dimensional and noisy data sets. Unlike kernel-based algorithms, other machine learning methods, such as neural networks (NN), are known to be sensitive to the noise and high dimensions of the data, and importantly, they tend to perform very poorly when large training data sets are not available. All of these properties make kernel-based algorithms very attractive alternatives for remote sensing researchers as the mentioned issues that kernel-based algorithms handle are well-known for remote sensing data [@gomez2011review].

Support Vector Regression (SVR) [@drucker1997support] is one of the most widely used KBMLRM [@verrelst2019quantifying]. One of the advantages of Support Vector Machines (SVM) (@boser1992training) over other ML methods such as ANN is that it mainly relies on minimizing the risk function, as opposed to trying to minimize the error in the training data set. Artificial neural networks, however, tries to minimize the error function, which makes them very susceptible to overfitting to the training data [@karimi2008application]. The applicability of SVM to estimate plant biophysical traits has been demonstrated in various studies. For example, @karimi2008application and @yang2011estimating used SVM to estimate plant biophysical parameters from hyperspectral remote sensing data. A study by @tuia2011multioutput demonstrated the successful use of multioutput SVR in order to retrieve the estimated biophysical parameters. Various studies compared the performance of SVR to the other ML methods. For example, @pullanagari2016mapping used different methods to map macro and micro nutrients from hyperspectral data. This study concluded that although SVR performed better for a certain parameter retrieval, this algorithm was not superior to the other ML methods in general.

Another widely used kernel-based ML method is Gaussian Process Regression (GPR). GPR is a Bayesian, non-parametric, and probabilistic ML method that provides important insights for retrieval of plant traits from remote sensing data [@camps2016survey; @camps2019perspective]. The major advantage of GPR over the other widely used ML algorithms is that GP models provide confidence intervals for the estimations [@berger2020retrieval]. In other words, besides providing very good results, GPR can also give information about how much uncertainty (e.g. error bars) exists in the predictions or estimations of the retrieved parameters. GPR can easily deal with different types of data and it can be implemented in a way that efficiently handles noise in the data. These issues commonly occur in remote sensing data, which makes the GPR algorithm very interesting for the remote sensing community [@camps2016survey; @camps2019perspective]. Successful applications of GPR to retrieve plant biophysical and biochemical variables have been demonstrated in the literature. A relatively recent study by @berger2020retrieval used two versions of GPR (homoscedastic and heteroscedastic) for retrieval of plant nitrogen content. This study showed that the both versions of GPR performed well for the retrieval of plant nitrogen content. @upreti2019comparison used different ML methods to retrieve plant traits from the multispectral remote sensing satellite data Seninel-2. They found GPR to be the best performing algorithm within the cross-validation stage, but not in general [@upreti2019comparison]. A study by @caicedo2014toward compared different ML models in terms of accuracy and concluded that GPR yielded the most accurate results. However, it is important to note that GPR does not come without drawbacks. For example, one of the main challenges of GPR is that it is computationally costly despite advances [@camps2019perspective].

### Artificial Neural Networks (ANN) {#ann}

Artificial Neural Networks (ANN) is a powerful ML method that consists of neurons and layers [@simon1999neural]. Usually, the ANN has three main components: an input layer, (a) hidden layer(s) and an output layer [@jensen1999predictive; @quan2017radiative]. A typical mechanism for training an ANN is that first a training data set is given to the model as an input layer and then, the model trains and predicts output. Once the predicted output is available, the current predicted output is compared to the true output so that the weight parameters can be adjusted in a way that the predicted and true output are closely similar [@ingram2005mapping; @quan2017radiative]. This learning process can be repeated multiple times until similarity between the predicted and true outputs is at a certain threshold (e.g. convergence). This threshold can be defined by the user depending on their preferences [@jensen1999predictive; @quan2017radiative]. 

Main advantages of ANN are their simplicity, computational efficiency and their ability to learn from data where linearity is not assumed [@schlerf2006inversion; @walczak2019artificial]. Furthermore, ANNs do not require any prior information about the distribution that the data come from unlike the traditional statistical methods [@walczak2019artificial].

ANNs have been utilized in the remote sensing domain, especially for plant property mapping, since the 1990s [@verrelst2019quantifying]. There are many studies in the literature that show the superiority of the ANN methods to more traditional statistical methods. For example, studies by @malenovsky2013retrieval and @kalacska2015estimation showed that compared to the traditional statistical and vegetation index (VI) methods, ANN yielded more accurate results for retrieval of plant parameters from hyperspectral remote sensing data. @neinavaz2016retrieval compared ANN's performance to other methods (e.g. linear parametric) and found that ANN was superior to the compared methods for retrieval of an important plant variable, LAI. Moreover, a recent study by @danner2021efficient used four widely used ML methods to retrieve plant traits and compared the results of each method. In general, ANN was found to be the best performing ML method among the others, considering the models' efficiency, robustness, accuracy, and computational time. 

Despite being a powerful ML method, ANN comes with drawbacks. There are many descriptors in a typical ANN that may be correlated to each other. Because of that, there is a risk of the model being stuck in the local minima. Another well-known challenge of ANN is that it is susceptible to overfitting. Fortunately, there have been many methods developed to deal with these problems (e.g. regularization) [@ghasemi2018neural]. A study by @schlerf2006inversion points out another potential drawback, which is the fact that the ANN model may behave unpredictably when the model does not represent the spectral properties of the target variable well.

### Challenges of Machine Learning Regression Algorithms (MLRA) {#chml}

There are common issues that almost all MLRAs are challenged with. Hyperspectral remote sensing data come with many bands that may be highly correlated and noisy. This problem is a well-known problem and it is also called the "Hughes phenomenon" [@hughes1968mean] or the "curse of dimensionality" [@danner2021efficient]. One of the main problems is that MLRAs' computational cost becomes higher with an increased amount of training data. Most MLRAs require high computational power for very costly training phases. Apart from that, many highly correlated bands may indicate highly redundant data which cause difficulties for statistical and ML methods [@rivera2017hyperspectral].

There are some methods that can be used to efficiently deal with the "curse of dimensionality" problem. Some of the most commonly used methods for dealing with this issue involve reducing the space (dimension) of the original data. @rivera2017hyperspectral indicate that this issue can be solved in two different domains. The first method involves choosing the samples that provide most of the information compared to the other samples. The second domain involves the use of feature selection or dimensionality reduction (DR) techniques. In the first technique, the amount of samples is minimized but accuracy is still a priority [@rivera2017hyperspectral].

The second set of techniques (DR) tries to reduce the original data space while keeping most of the information available. In other words, DR techniques convert a large number of features with a high amount of redundancy into a much smaller feature set with no or as little redundancy as possible [@lee2007nonlinear]. Two of the commonly used DR techniques to compress the spectral reflectance data in remote sensing are so-called wavelet transform (WT) and principal component analysis (PCA) [@ke2016estimating].

After reducing the dimension of the original data, new and low-dimensional data can be used to train ML models. MLRAs can be combined with PCA to reduce the computational cost and avoid the "curse of dimensionality" problem. There have been studies comparing the performance of ML methods when combined with DR techniques to feature selection or VI based ML applications. For example, @liu2017hyperspectral compared the performance of PCA based ANN with VI based ANN and concluded that using PCA before training is superior to using VI in the training phase. However, it is also important to note that PCA is not the only DR technique, although it is the most commonly used DR technique in plant retrieval studies by remote sensing researchers. A study by @rivera2017hyperspectral reviews and compares different DR techniques and concludes that PCA is not always the best performing DR technique and the use of other techniques may yield better results in some cases.

In general, most ML algorithms need a large amount of training data to learn from the training data and generalize well to the data that were not used in the training phase (e.g. test data). This leads to another challenging property of ML for retrieval of plant biophysical traits. This is because of the fact that it is extremely difficult to collect enough training data for plant traits in the field for a ML method to perform well. It requires various *in-situ* field techniques and these techniques need to be used in a limited time-frame. It is still not guaranteed that training data collected in the field can generalize well to other fields [@danner2021efficient]. One way to overcome this problem is to use the so-called hybrid-machine learning method.

## Hybrid Machine Learning Method {#hml}

The hybrid machine learning method is a combination of physically based RTMs and MLRAs. The main idea behind this technique is to make use of the advantages of the two different methods at the same time. RTMs can provide simulated data based on well-known and approved physical laws. Therefore, the data provided by RTMs can be applicable universally. Machine learning methods provide opportunities to efficiently deal with non-linear data (without making assumptions) in a reasonable time frame [@abdelbaki2021comparison; @de2020quantifying; @berger2021survey; @ke2016estimating]. The study by @fernandez2021hybrid mentions three main advantages of using the hybrid method over other techniques: better generalization of the model, better estimation of the biophysical parameters, and finally, more efficient computation.

A typical procedure for using hybrid machine learning methods to retrieve plant biophysical variables involves simulating coupled leaf and canopy models (e.g. PROSAIL) and storing the simulated data in the so-called look-up-table (LUT). The LUT typically stores simulated reflectance data and a wide range of plant parameters. Once the LUT is available, a ML model can be trained using all the information available in the LUT as a training data set [@verrelst2019quantifying].

There have been a large number of studies utilizing hybrid machine learning methods for retrieval of plant traits. For example, a recent study by @cesar2021exploring combines PROSAIL and widely used MLRAs with the hybrid approach in order to retrieve plant parameters from Sentinel-2 satellite data. In this study, the performance of each MLRA combined with PROSAIL was assessed when noise was added. In the study by @wei2017estimation, plant LAI was successfully estimated using random forest regression and PROSAIL in a hybrid work flow. @verrelst2016active used hybrid RTM and kernel-based machine learning techniques to estimate plant leaf area index and chlorophyll content. This study included the active learning (AL) technique for an efficient retrieval strategy.