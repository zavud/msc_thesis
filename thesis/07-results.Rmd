# Results

## Local sensitivity analysis

Figure \@ref(fig:fsens) shows the result of sensitivity analysis. Chlorophyll content ($C_{ab}$) appears to almost exclusively impact the visible spectra. Some effect can also be noticed in the red-edge, but there is not a significant effect of varying $C_{ab}$ on the simulated spectra within the near-infrared (NIR) and short wave infrared (SWIR) (Figure \@ref(fig:fsens).a). Conversely, equivalent water thickness ($C_{w}$) (Figure \@ref(fig:fsens).b) and leaf dry matter content ($C_{m}$) (Figure \@ref(fig:fsens).c) both have large effects on simulated spectra within the NIR and SWIR but no significant effect within the visible spectra. Leaf Area Index (single) ($LAI_{s}$) (Figure \@ref(fig:fsens).d), Crown diameter ($CD$) (Figure \@ref(fig:fsens).e)) and Stem density (Figure \@ref(fig:fsens).f) all have noticeable effect on the simulated canopy reflectance almost all over the spectra.

\newpage

```{r fsens, warning=FALSE, message=FALSE, echo=FALSE, cache=TRUE, out.height="80%", fig.align='center', fig.cap="Effects of varying the chosen parameters on the simulated spectra"}
knitr::include_graphics("C:/Users/zavud/Desktop/msc_thesis/thesis/figures/sensitivity_results.pdf")
```

\newpage

## RTM simulation (INFORM)

Synthetic canopy reflectance data set were produced and stored in a LUT containing all 316,800 simulations. In this research, LUT was defined as a matrix. Each row of this matrix is a different simulated spectra and columns are simulated reflectance of wavelengths with the range of 400nm-2500nm with 1nm spectral resolution and 6 additional columns containing values of the corresponding variables $C_{ab}$, $C_{w}$, $C_{m}$, $LAI_{s}$, $CD$ and $SD$ that were used for each simulation. Hence the dimensions of the LUT matrix is 316,800 rows (number of simulations) by 2107 columns (2101 simulated "bands" + 6 INFORM variables):

\begingroup
\tiny
$$
\begin{bmatrix}
400nm_{1} & \dots & 2500nm_{1} & Cab_{1} & Cw_{1} & Cm_{1} & LAIs_{1} & CD_{1} & SD_{1}\\
400nm_{2} & \dots & 2500nm_{2} & Cab_{2} & Cw_{2} & Cm_{2} & LAIs_{2} & CD_{2} & SD_{2}\\
\ \vdots  &\ \vdots &\ \vdots &\ \vdots &\ \vdots &\ \vdots &\ \vdots &\ \vdots &\ \vdots\\
400nm_{316,800} & \dots & 2500nm_{316,800} & Cab_{316,800} & Cw_{316,800} & Cm_{316,800} & LAIs_{316,800} & CD_{316,800} & SD_{316,800}
\end{bmatrix}
$$
\endgroup

In this matrix, $400nm_{n}$, $\dots$, $2500nm_{n}$ refer to the simulated reflectance for the corresponding wavelength in the simulation number $n$. $Cab_{n}$, $Cw_{n}$, $Cm_{n}$, $LAIs_{n}$, $CD_{n}$ and $SD_{n}$ are values of the INFORM parameters that were used in the $n$th simulation.

## Spectral resampling

The output of INFORM simulations were resampled to 231 PRISMA bands. The LUT matrix was used for spectral resampling and the resulting matrix has a dimension of 316,800 rows (number of simulations) by 237 columns (231 PRISMA image bands + 6 INFORM variables):

\begingroup
\tiny
$$
\begin{bmatrix}
Band1_{1} & \dots & Band231_{1} & Cab_{1} & Cw_{1} & Cm_{1} & LAIs_{1} & CD_{1} & SD_{1}\\
Band1_{2} & \dots & Band231_{2} & Cab_{2} & Cw_{2} & Cm_{2} & LAIs_{2} & CD_{2} & SD_{2}\\
\ \vdots  &\ \vdots &\ \vdots &\ \vdots &\ \vdots &\ \vdots &\ \vdots &\ \vdots &\ \vdots\\
Band1_{316,800} & \dots & Band231_{316,800} & Cab_{316,800} & Cw_{316,800} & Cm_{316,800} & LAIs_{316,800} & CD_{316,800} & SD_{316,800}
\end{bmatrix}
$$
\endgroup

In this matrix, $Band1_{n}$, $\dots$, $Band231_{n}$ correspond to the simulated reflectance for the corresponding image band in the simulation number $n$. $Cab_{n}$, $Cw_{n}$, $Cm_{n}$, $LAIs_{n}$, $CD_{n}$ and $SD_{n}$ refer to the values of the INFORM parameters that were used in the $n$th simulation.

## Statistics of simulated data and PRISMA image

The Figure \@ref(fig:statplots) shows statistical information (mean and mean $\pm$ standard deviation) calculated from the LUT and PRISMA image:

```{r statplots, warning=FALSE, message=FALSE, echo=FALSE, out.width="90%", fig.cap="Mean and mean $\\pm$ standard deviation in the a) LUT and b) PRISMA image", cache=TRUE}
knitr::include_graphics("C:/Users/zavud/Desktop/msc_thesis/thesis/figures/stats.pdf")
```

Mean and standard deviation within the LUT are much smoother compared to mean and standard deviation within the PRISMA image spectra. This is due to the fact that INFORM model does not add noise during the simulation which can commonly exist in remote sensing images. There is a noticeable amount of noise in the PRISMA image spectra. Some of the noise in the image spectra could potentially be due to the fact that the PRISMA image contained cloud and shadow within the study area and although most of the cloud and shadow pixels were masked, the nearby pixels could still be affected.

The Figure \@ref(fig:meancomparison) shows the difference between averaged reflectance within the simulated database (LUT) and PRISMA image. 

```{r meancomparison, warning=FALSE, message=FALSE, echo=FALSE, out.width="80%", fig.align='center', fig.cap="Difference between averaged LUT and PRISMA image reflectance", cache=TRUE}
knitr::include_graphics("C:/Users/zavud/Desktop/msc_thesis/thesis/figures/meancomparison_lut_vs_prisma.pdf")
```

The LUT appears to have higher average reflectance within the visible spectra compared to the PRISMA image spectra. Differences within the water absorbtion bands can also be clearly seen. There is relatively good agreement within the NIR spectrum.

\newpage

## Gaussian noise

The Figure \@ref(fig:noise) shows the effect of adding 3% Gaussian noise to the simulated data.

```{r noise, warning=FALSE, message=FALSE, echo=FALSE, out.width="90%", fig.cap="Effect of adding $3\\%$ Gaussian noise to the simulated spectra. The randomly chosen pixel from the PRISMA data was plotted to illustrate the noise found typically in the image", cache=TRUE}
knitr::include_graphics("C:/Users/zavud/Desktop/msc_thesis/thesis/figures/noise.pdf")
```

The Figure \@ref(fig:noise).a shows a simulated spectra that seems perfectly smooth. However, after adding 3% Gaussian noise, the simulated spectra is not as smooth anymore and contains random noise all over the whole spectra (Figure \@ref(fig:noise).b). This also makes the simulated spectra more similar to the pixel extracted from the PRISMA image.

## Principal Component Analysis (PCA)

The result of PCA show that most of the variation in the simulated data can be explained by much fewer variables (PCs):

```{r pca, warning=FALSE, message=FALSE, echo=FALSE, out.width="90%", fig.cap="Principal Component Analysis: a) Screeplot, b) Cumulative variance explained by the first 5 PCs", cache=FALSE}
knitr::include_graphics("C:/Users/zavud/Desktop/msc_thesis/thesis/figures/pca.pdf")
```

The Figure \@ref(fig:pca).a shows the screeplot of the PCA result. The first PC explains the most of the variation and together with the next 4 PCs we can capture more than 99% of the variation that is present in the original data (Figure \@ref(fig:pca).b). This, once again shows the multicollinearity problem with hyperspectral data.











